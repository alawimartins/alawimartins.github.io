<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer</title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:900&display=swap" rel="stylesheet">
</head>

<body>
    <div class="firstContainer">
        <div class="firstRow">
            <div class="workOrStop firstblock"> 
                <div class='workOrStopText'>
                    <p class="workTextParagraph">Work</p>
                    <div class="signs">
                        <svg class="heartSvg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z"/></svg>               
                        <svg class="stopSvg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.728 3l5.272 5.272v7.456l-5.272 5.272h-7.456l-5.272-5.272v-7.456l5.272-5.272h7.456zm8.272 4.029v9.941l-7.029 7.03h-9.942l-7.029-7.029v-9.942l7.029-7.029h9.941l7.03 7.029zm-2 .829l-5.858-5.858h-8.284l-5.858 5.858v8.284l5.858 5.858h8.284l5.858-5.858v-8.284z"/></svg>
                    </div>
                </div>
            </div>
            <div class="seconds firstblock">
                <div class='containerParagraph'>
                    <p id="timer">50</p>
                    
                </div>
                
    
                <svg class= "circleSvg" viewBox="-100 -100 200 200"> <!-- viewBox defines the coordinate system.-->
                    <circle class="greyBorder" cx="0" cy="0" r="85" />
                    <circle class="outer" cx="0" cy="0" r="85" />
                </svg>
                
                
            </div>
            <div class="sets firstblock">
                <div class='setsText'>
                    <p class="lapText">Laps Left: </p>
                    <p id= "round">5</p>
        
                </div>
            </div>
    

        </div>
        <div class="secondRow">
            <div>
                <h3 id= "exerciseType"></h3>
            </div>
            <div>
                <div class="imageAndStation">
                    <img id="myImg" src="images/wednesday/9crocodile-walk.jpg" width="800" height="400">
                    <div class="buttonsLeftRight">
                        <div class="buttons" id="previous">&lt;</div>
                        <div class="buttons" id="next">&gt;</div>
                    </div>
                    <div id="stationNumber">
                        <p id="stationNumberText">1</p>
                        
                        
                    </div>
                    
                    <div class="parentIcons">
                        <div class="icons">
                            <div class="refresh">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13.5 2c-5.629 0-10.212 4.436-10.475 10h-3.025l4.537 5.917 4.463-5.917h-2.975c.26-3.902 3.508-7 7.475-7 4.136 0 7.5 3.364 7.5 7.5s-3.364 7.5-7.5 7.5c-2.381 0-4.502-1.119-5.876-2.854l-1.847 2.449c1.919 2.088 4.664 3.405 7.723 3.405 5.798 0 10.5-4.702 10.5-10.5s-4.702-10.5-10.5-10.5z"/></svg>
                            </div>
                            <div class="play">
                                <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M23 12l-22 12v-24l22 12zm-21 10.315l18.912-10.315-18.912-10.315v20.63z"/></svg>
                            </div>
                            <div class="paused">
                                <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M10 24h-6v-24h6v24zm10 0h-6v-24h6v24zm-11-23h-4v22h4v-22zm10 0h-4v22h4v-22z"/></svg>
                            </div>
                                
                            <div class="home">
                              <a href="home.html"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M22 11.414v12.586h-20v-12.586l-1.293 1.293-.707-.707 12-12 12 12-.707.707-1.293-1.293zm-6 11.586h5v-12.586l-9-9-9 9v12.586h5v-9h8v9zm-1-7.889h-6v7.778h6v-7.778z"/></svg></a>  
                            </div>  
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
            <div class="barDiv">
                <div id="myProgress">
                    <div id="myBar">0%</div>
                </div>
            </div>
        
    </div>
    
                    
    <audio src="Asian Gong Hit-SoundBible.com-1634281527.mp3" id="timerAudio"></audio>
    <audio src="cheer2.mp3" id="finishAudio"></audio>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.2.4/gsap.min.js"></script>
    <script>

    const currentUrl = window.location.href;
    const url = new URL(currentUrl);
    const day = url.searchParams.get("day") || "monday";

    const workoutData = {
        monday: [{ description: "BURPEE ONE LEGGED", imageSource:"images/1singleLegBurpee.gif"},{description:"TUCK JUMPS", imageSource:"images/introjump.gif"},{description: "SQUAD PULSE",imageSource:"images/3exercise-squat-pulse.gif"},{description:"HIGH KNEES, SINGLE KNEE", imageSource:"images/4Plyometrics-High-Knees.gif"},{description:"5.MOVING PLANK" ,imageSource:"images/5walking-plank.gif"},{description: "INCH WORM",imageSource:"images/6Inchworm.gif"},{description:"LATERAL TUCK JUMPS" ,imageSource:"images/7tuck-jumps.gif"},{description:"MOUNTAIN CLIMBERS" ,imageSource:"images/8mountain-climbers.gif"},{description:"BEAR CRAWL + REVERSE" ,imageSource:"images/9Bear-Crawl.gif"}],
        tuesday:[{description: "REVERSE BURPEE",imageSource: "images/tuesday/1.reverseburpee.gif" }, {description:"HAND WALKS IN HAND WALKS OUT" ,imageSource: "images/6Inchworm.gif" },{description: "ICE SKATER"  ,imageSource: "images/tuesday/3.iceskater.gif" },{description: "PUSH UP JACK"  ,imageSource: "images/tuesday/4Push-Up-Jack_Exercise.gif" },{description: "PLANKS FEET TWISTS" ,imageSource: "images/tuesday/5.planksfeettwist.gif" },{description: "SQUAT PULSE COMBO" ,imageSource: "images/tuesday/6pulse-squat.gif" },{description: "5X JACKNIVES + 5X CRUNCHES" ,imageSource: "images/tuesday/7. crunches.gif" },{description: "MOUNTAIN CLIMBERS WIDE"  ,imageSource: "images/tuesday/8.mountainwide.gif" },{description: "SPRINTING LUNGES"  ,imageSource: "images/tuesday/9.sprinters-lunge-hip-exercise.gif"}],
        wednesday:[{description: "MOUNTAIN CLIMBERS" ,imageSource: "images/wednesday/1.mountainclimbers.gif" }, {description: "BURPEE HANDS OFF"  ,imageSource: "images/wednesday/2.BURPEE.gif" },{description: "10X HEEL TOUCHES + 4X ICE SKATER " ,imageSource:"images/wednesday/3HEELTOUCHES.gif" },{description:  "SQUAD MIDPOINT ALTERNATIVE REVERSE LUNGES" ,imageSource: "images/wednesday/4.SQUAD MIDPOINT.gif" },{description: "MOVING PLANK"  ,imageSource: "images/wednesday/5Plank-Walkdown.gif" },{description: "TUCK JUMP",imageSource: "images/wednesday/6TUCK JUMP.gif" },{description: "TRICEP PUSH UP + FOOT JACKS"  ,imageSource: "images/wednesday/7crossjacks.gif" },{description: "10X BICYCLE KICKS + KICKS + 5X JACKKNIVES" ,imageSource: "images/wednesday/8SpiritedThreadbareLeafbird-small.gif" },{description: "GORILLA BOUNDS " ,imageSource: "images/9Bear-Crawl.gif" }],
        thursday: [{ description: "BURPEE ONE LEGGED", imageSource:"images/1singleLegBurpee.gif"},{description:"TUCK JUMPS", imageSource:"images/introjump.gif"},{description: "SQUAD PULSE",imageSource:"images/3exercise-squat-pulse.gif"},{description:"HIGH KNEES, SINGLE KNEE", imageSource:"images/4Plyometrics-High-Knees.gif"},{description:"5.MOVING PLANK" ,imageSource:"images/5walking-plank.gif"},{description: "INCH WORM",imageSource:"images/6Inchworm.gif"},{description:"LATERAL TUCK JUMPS" ,imageSource:"images/7tuck-jumps.gif"},{description:"MOUNTAIN CLIMBERS" ,imageSource:"images/8mountain-climbers.gif"},{description:"BEAR CRAWL + REVERSE" ,imageSource:"images/9Bear-Crawl.gif"}],
        friday:[{description: "REVERSE BURPEE",imageSource: "images/tuesday/1.reverseburpee.gif" }, {description:"HAND WALKS IN HAND WALKS OUT" ,imageSource: "images/6Inchworm.gif" },{description: "ICE SKATER"  ,imageSource: "images/tuesday/3.iceskater.gif" },{description: "PUSH UP JACK"  ,imageSource: "images/tuesday/4Push-Up-Jack_Exercise.gif" },{description: "PLANKS FEET TWISTS" ,imageSource: "images/tuesday/5.planksfeettwist.gif" },{description: "SQUAT PULSE COMBO" ,imageSource: "images/tuesday/6pulse-squat.gif" },{description: "5X JACKNIVES + 5X CRUNCHES" ,imageSource: "images/tuesday/7. crunches.gif" },{description: "MOUNTAIN CLIMBERS WIDE"  ,imageSource: "images/tuesday/8.mountainwide.gif" },{description: "SPRINTING LUNGES"  ,imageSource: "images/tuesday/9.sprinters-lunge-hip-exercise.gif"}],
        saturday:[{description: "MOUNTAIN CLIMBERS" ,imageSource: "images/wednesday/1.mountainclimbers.gif" }, {description: "BURPEE HANDS OFF"  ,imageSource: "images/wednesday/2.BURPEE.gif" },{description: "10X HEEL TOUCHES + 4X ICE SKATER " ,imageSource:"images/wednesday/3HEELTOUCHES.gif" },{description:  "SQUAD MIDPOINT ALTERNATIVE REVERSE LUNGES" ,imageSource: "images/wednesday/4.SQUAD MIDPOINT.gif" },{description: "MOVING PLANK"  ,imageSource: "images/wednesday/5Plank-Walkdown.gif" },{description: "TUCK JUMP",imageSource: "images/wednesday/6TUCK JUMP.gif" },{description: "TRICEP PUSH UP + FOOT JACKS"  ,imageSource: "images/wednesday/7crossjacks.gif" },{description: "10X BICYCLE KICKS + KICKS + 5X JACKKNIVES" ,imageSource: "images/wednesday/8SpiritedThreadbareLeafbird-small.gif" },{description: "GORILLA BOUNDS " ,imageSource: "images/9Bear-Crawl.gif" }],
       
    }
    let timeElapsed = 0
    let seconds =0
    let roundLevel =4
    let numberExercisesDone =0
    let station = 1 
    let arrOfStations = workoutData[day];
    const bar = document.getElementById("myBar");
    const numOfLaps = arrOfStations.length*roundLevel;
const element = document.getElementById('timer')
const round = document.getElementById('round')
const exercise = document.getElementById('exerciseType')
const image = document.getElementById("myImg")
const stationNumberText = document.getElementById("stationNumberText")
const timerSquare= document.querySelector(".seconds")
const heartSvg = document.querySelector(".heartSvg")
const stopSvg = document.querySelector(".stopSvg")
const workTextParagraph= document.querySelector(".workTextParagraph")
const outer = document.querySelector(".outer")
const icons = document.querySelector(".icons")
const body = document.body
const pausedSvg = document.querySelector(".paused")
const playSvg = document.querySelector(".play")
const refreshSvg = document.querySelector(".refresh")
const previousBtn = document.getElementById('previous')
const nextBtn = document.getElementById('next')
let percent = 0


let restStart = 44
let restEnd = 60
let effortStart = 0
let efforEnd = 44
let i =0
let paused = false
exercise.innerHTML = arrOfStations[i].description
image.src = arrOfStations[i].imageSource

let hasChangedExercice = false;
let startExercise= false
circleRotation45()

let frames = 0;
const totalFrames = numOfLaps * restEnd * 60 - (restEnd - restStart) * 60;

function update() // RequestAnimationFrame
{   
    

    if (frames > totalFrames) {
        frames = totalFrames;
    }
    percent = frames/totalFrames*100
    bar.style.width = percent + "%"
    bar.innerHTML = Math.floor(percent * 10) / 10 + "%"

    if(paused) {
        return
    }

    timeElapsed += 1 / 60;
    seconds = Math.floor(timeElapsed);

    frames++;


    

    if (seconds >= effortStart && seconds <= efforEnd) {
    
        

    } else if (seconds >restStart && seconds<= restEnd) {
        if (!hasChangedExercice) {
            i = i +1
            document.getElementById("timerAudio").play()
            numberExercisesDone = numberExercisesDone +1
            // percent = Math.floor(numberExercisesDone/numOfLaps*100)
            // bar.style.width = percent + "%"
            // bar.innerHTML = percent + "%"
            stationNumberText.innerHTML = i + 1
            timerSquare.style.backgroundColor = "red"; 
            heartSvg.style.display = "none"
            stopSvg.style.display = "block"
            workTextParagraph.innerHTML = "Rest"
            circleRotation15()
            hasChangedExercice = true;
        }
        
        if (i === arrOfStations.length) {
            i = 0;
            roundLevel = roundLevel - 1
            stationNumberText.innerHTML = i + 1

            if (roundLevel===0) {
                // document.body.innerHTML= "<h1>youWINNNN</h1>"
                document.getElementById("finishAudio").play()
                return
            }
            
        }

        exercise.innerHTML = arrOfStations[i].description
        image.src = arrOfStations[i].imageSource

        
        
        
        //change color to red 
    } else if (seconds>restEnd) {
        timeElapsed = 0
        document.getElementById("timerAudio").play()
        heartSvg.style.display = "block"
        stopSvg.style.display = "none"
        timerSquare.style.backgroundColor = "rgb(33, 170, 33)"
        workTextParagraph.innerHTML = "Work"
        circleRotation45()
        hasChangedExercice = false;
    }

    window.requestAnimationFrame(update)
  
    element.innerHTML = `00:${seconds}`
    round.innerHTML = `${roundLevel}`
}

window.requestAnimationFrame(update);

function circleRotation45() {

    outer.style.strokeDashoffset = 534;
    gsap.killTweensOf(".outer")
    gsap.to(".outer", {
        duration: 44,  
        strokeDashoffset: 0
    });
}

function circleRotation15() {
    outer.style.strokeDashoffset = 534;
    gsap.to(".outer", {
        duration: 15,  
        strokeDashoffset: 0
    })
}

function iconsPop() {
    icons.style.visibility = "visible";
}
function pausedClicked() {
    paused = true;
    gsap.globalTimeline.pause()
    // setTimeout(()=>{
        // gsap.globalTimeline.play()
    // }, 1000)
}
function playClick() {
    if (paused===true) {
        console.log(paused, 'paused')
    paused=false
    update()
    gsap.globalTimeline.play()
    }
    
}


function next () {
    i++
    circleRotation45() 
    console.log(0)
    if (i === arrOfStations.length) {
        console.log(1)
        roundLevel = roundLevel - 1
        round.innerHTML = `${roundLevel}`
        

        if (roundLevel<1) {
            numberExercisesDone = numberExercisesDone +1
            frames = totalFrames;

            if(roundLevel<1) {
                frames = totalFrames;
                document.getElementById("finishAudio").play()

                paused = true;
            }
            
        } else {
            i = 0;
            stationNumberText.innerHTML = i + 1
            exercise.innerHTML = arrOfStations[i].description
            image.src = arrOfStations[i].imageSource
            numberExercisesDone = numberExercisesDone +1
        }
            
    } else {
        exercise.innerHTML = arrOfStations[i].description
        image.src = arrOfStations[i].imageSource
        stationNumberText.innerHTML = i + 1
        timeElapsed = 0
        seconds = Math.floor(timeElapsed);
        element.innerHTML = `00:${seconds}`
        document.getElementById("timerAudio").play()
        heartSvg.style.display = "block"
        stopSvg.style.display = "none"
        timerSquare.style.backgroundColor = "rgb(33, 170, 33)"
        workTextParagraph.innerHTML = "Work"
        hasChangedExercice = false;
        numberExercisesDone = numberExercisesDone +1
        // percent = Math.floor(numberExercisesDone/numOfLaps*100)
        // bar.style.width = percent + "%";
        // bar.innerHTML = percent + "%";
        round.innerHTML = `${roundLevel}`

    }

    frames = numberExercisesDone * restEnd * 60;
    
        
}

function previous() {
    i--
    numberExercisesDone = numberExercisesDone - 1

    if(i>=0){
        timeElapsed = 0
        seconds = Math.floor(timeElapsed);
        element.innerHTML = `00:${seconds}`
        exercise.innerHTML = arrOfStations[i].description
        image.src = arrOfStations[i].imageSource
        stationNumberText.innerHTML = i +1
        circleRotation45()
        document.getElementById("timerAudio").play()
        heartSvg.style.display = "block"
        stopSvg.style.display = "none"
        timerSquare.style.backgroundColor = "rgb(33, 170, 33)"
        workTextParagraph.innerHTML = "Work"
        hasChangedExercice = false;
    }
    
        
    if (i <0 && roundLevel <4) {
        i= arrOfStations.length -1
        numberExercisesDone = numberExercisesDone + 1
        roundLevel = roundLevel + 1
        round.innerHTML = `${roundLevel}`
        timeElapsed = 0
        seconds = Math.floor(timeElapsed);
        element.innerHTML = `00:${seconds}`
        exercise.innerHTML = arrOfStations[i].description
        image.src = arrOfStations[i].imageSource
        stationNumberText.innerHTML = i +1
        circleRotation45()
        
    } else if (i<0 && roundLevel>=4) {
        i=0
        stationNumberText.innerHTML= 1
        numberExercisesDone=0
    }

    frames = numberExercisesDone * restEnd * 60;
}

body.addEventListener("mousemove", iconsPop)
pausedSvg.addEventListener("click",pausedClicked)
playSvg.addEventListener("click",playClick)
refreshSvg.addEventListener('click', function(){
    location.reload();
    return false
} )
nextBtn.addEventListener('click',next)
previousBtn.addEventListener('click',previous)





    </script>
</body>
</html>